//I think this is where all the replacing code happens